{"cells": [{"metadata": {"id": "0c397d3dde9e40b09d107035a52515a4"}, "cell_type": "markdown", "source": "# Multi-Cloud Data Governance with Data Virtualization and Cloud Pak for Data"}, {"metadata": {"id": "a3055b7c82ae436880b9ea6b3a10de42"}, "cell_type": "markdown", "source": "Online version: <url>"}, {"metadata": {"id": "a030089d19ca4737ac5f8d043f4b2b29"}, "cell_type": "markdown", "source": "### Sample database schema consists of the following tables:\n\n- Big Query - GCP\n   - Products: stores a list of scale model cars. \n   - ProductLines: stores a list of product line categories. \n- Db2 for i - On Prems :\n   - Customers: stores customer\u2019s data.  \n   - Orders: stores sales orders placed by customers.\n   - OrderDetails: stores sales order line items for each sales order.\n   - Payments: stores payments made by customers based on their accounts.\n- Oracle AIX - On prems :  \n   - Employees: stores all employee information as well as the organization structure such as who reports to whom.\n   - Offices: stores sales office data."}, {"metadata": {"id": "ac02b4c3-af8b-4768-8d31-0ac9883f15da"}, "cell_type": "code", "source": "import itc_utils.flight_service as itcfs\n\nreadClient = itcfs.get_flight_client()\n\nretail_dv_data_request = {\n    'connection_name': \"\"\"retail-dv\"\"\",\n    'select_statement': 'SELECT * FROM \"RETAIL\".\"CUSTOMERS\"'\n}\n\nflightInfo = itcfs.get_flight_info(readClient, nb_data_request=retail_dv_data_request)\n\ndata_df_1 = itcfs.read_pandas_and_concat(readClient, flightInfo)\ndata_df_1.head(10)\n", "execution_count": 1, "outputs": [{"output_type": "execute_result", "execution_count": 1, "data": {"text/plain": "  CUSTOMERNUMBER                  CUSTOMERNAME  CONTACTLASTNAME  \\\n0            103             Atelier graphique          Schmitt   \n1            112            Signal Gift Stores             King   \n2            114    Australian Collectors, Co.         Ferguson   \n3            119             La Rochelle Gifts          Labrune   \n4            121            Baane Mini Imports       Bergulfsen   \n5            124  Mini Gifts Distributors Ltd.           Nelson   \n6            125            Havel & Zbyszek Co  Piestrzeniewicz   \n7            128          Blauer See Auto, Co.           Keitel   \n8            129               Mini Wheels Co.           Murphy   \n9            131             Land of Toys Inc.              Lee   \n\n  CONTACTFIRSTNAME              PHONE                  ADDRESSLINE1  \\\n0          Carine          40.32.2555                54, rue Royale   \n1             Jean         7025551838               8489 Strong St.   \n2            Peter       03 9520 4555             636 St Kilda Road   \n3          Janine          40.67.8555  67, rue des Cinquante Otages   \n4           Jonas          07-98 9555        Erling Skakkes gate 78   \n5            Susan         4155551450               5677 Strong St.   \n6         Zbyszek       (26) 642-7555               ul. Filtrowa 68   \n7           Roland  +49 69 66 90 2555                 Lyonerstr. 34   \n8            Julie         6505555787     5557 North Pendale Street   \n9             Kwai         2125557818       897 Long Airport Avenue   \n\n  ADDRESSLINE2           CITY     STATE POSTALCODE    COUNTRY  \\\n0         addr         Nantes      None      44000     France   \n1         None      Las Vegas        NV      83030        USA   \n2      Level 3      Melbourne  Victoria       3004  Australia   \n3         None         Nantes      None      44000     France   \n4         None        Stavern      None       4110     Norway   \n5         None     San Rafael        CA      97562        USA   \n6         None       Warszawa      None     01-012     Poland   \n7         None      Frankfurt      None      60528    Germany   \n8         None  San Francisco        CA      94217        USA   \n9         None            NYC        NY      10022        USA   \n\n  SALESREPEMPLOYEENUMBER CREDITLIMIT  \n0                   1370    21000.00  \n1                   1166    71800.00  \n2                   1611   117300.00  \n3                   1370   118200.00  \n4                   1504    81700.00  \n5                   1165   210500.00  \n6                   None        0.00  \n7                   1504    59700.00  \n8                   1165    64600.00  \n9                   1323   114900.00  ", "text/html": "<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>CUSTOMERNUMBER</th>\n      <th>CUSTOMERNAME</th>\n      <th>CONTACTLASTNAME</th>\n      <th>CONTACTFIRSTNAME</th>\n      <th>PHONE</th>\n      <th>ADDRESSLINE1</th>\n      <th>ADDRESSLINE2</th>\n      <th>CITY</th>\n      <th>STATE</th>\n      <th>POSTALCODE</th>\n      <th>COUNTRY</th>\n      <th>SALESREPEMPLOYEENUMBER</th>\n      <th>CREDITLIMIT</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>103</td>\n      <td>Atelier graphique</td>\n      <td>Schmitt</td>\n      <td>Carine</td>\n      <td>40.32.2555</td>\n      <td>54, rue Royale</td>\n      <td>addr</td>\n      <td>Nantes</td>\n      <td>None</td>\n      <td>44000</td>\n      <td>France</td>\n      <td>1370</td>\n      <td>21000.00</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>112</td>\n      <td>Signal Gift Stores</td>\n      <td>King</td>\n      <td>Jean</td>\n      <td>7025551838</td>\n      <td>8489 Strong St.</td>\n      <td>None</td>\n      <td>Las Vegas</td>\n      <td>NV</td>\n      <td>83030</td>\n      <td>USA</td>\n      <td>1166</td>\n      <td>71800.00</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>114</td>\n      <td>Australian Collectors, Co.</td>\n      <td>Ferguson</td>\n      <td>Peter</td>\n      <td>03 9520 4555</td>\n      <td>636 St Kilda Road</td>\n      <td>Level 3</td>\n      <td>Melbourne</td>\n      <td>Victoria</td>\n      <td>3004</td>\n      <td>Australia</td>\n      <td>1611</td>\n      <td>117300.00</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>119</td>\n      <td>La Rochelle Gifts</td>\n      <td>Labrune</td>\n      <td>Janine</td>\n      <td>40.67.8555</td>\n      <td>67, rue des Cinquante Otages</td>\n      <td>None</td>\n      <td>Nantes</td>\n      <td>None</td>\n      <td>44000</td>\n      <td>France</td>\n      <td>1370</td>\n      <td>118200.00</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>121</td>\n      <td>Baane Mini Imports</td>\n      <td>Bergulfsen</td>\n      <td>Jonas</td>\n      <td>07-98 9555</td>\n      <td>Erling Skakkes gate 78</td>\n      <td>None</td>\n      <td>Stavern</td>\n      <td>None</td>\n      <td>4110</td>\n      <td>Norway</td>\n      <td>1504</td>\n      <td>81700.00</td>\n    </tr>\n    <tr>\n      <th>5</th>\n      <td>124</td>\n      <td>Mini Gifts Distributors Ltd.</td>\n      <td>Nelson</td>\n      <td>Susan</td>\n      <td>4155551450</td>\n      <td>5677 Strong St.</td>\n      <td>None</td>\n      <td>San Rafael</td>\n      <td>CA</td>\n      <td>97562</td>\n      <td>USA</td>\n      <td>1165</td>\n      <td>210500.00</td>\n    </tr>\n    <tr>\n      <th>6</th>\n      <td>125</td>\n      <td>Havel &amp; Zbyszek Co</td>\n      <td>Piestrzeniewicz</td>\n      <td>Zbyszek</td>\n      <td>(26) 642-7555</td>\n      <td>ul. Filtrowa 68</td>\n      <td>None</td>\n      <td>Warszawa</td>\n      <td>None</td>\n      <td>01-012</td>\n      <td>Poland</td>\n      <td>None</td>\n      <td>0.00</td>\n    </tr>\n    <tr>\n      <th>7</th>\n      <td>128</td>\n      <td>Blauer See Auto, Co.</td>\n      <td>Keitel</td>\n      <td>Roland</td>\n      <td>+49 69 66 90 2555</td>\n      <td>Lyonerstr. 34</td>\n      <td>None</td>\n      <td>Frankfurt</td>\n      <td>None</td>\n      <td>60528</td>\n      <td>Germany</td>\n      <td>1504</td>\n      <td>59700.00</td>\n    </tr>\n    <tr>\n      <th>8</th>\n      <td>129</td>\n      <td>Mini Wheels Co.</td>\n      <td>Murphy</td>\n      <td>Julie</td>\n      <td>6505555787</td>\n      <td>5557 North Pendale Street</td>\n      <td>None</td>\n      <td>San Francisco</td>\n      <td>CA</td>\n      <td>94217</td>\n      <td>USA</td>\n      <td>1165</td>\n      <td>64600.00</td>\n    </tr>\n    <tr>\n      <th>9</th>\n      <td>131</td>\n      <td>Land of Toys Inc.</td>\n      <td>Lee</td>\n      <td>Kwai</td>\n      <td>2125557818</td>\n      <td>897 Long Airport Avenue</td>\n      <td>None</td>\n      <td>NYC</td>\n      <td>NY</td>\n      <td>10022</td>\n      <td>USA</td>\n      <td>1323</td>\n      <td>114900.00</td>\n    </tr>\n  </tbody>\n</table>\n</div>"}, "metadata": {}}]}, {"metadata": {"id": "f525ec523f5c424a80079a8db04201ac"}, "cell_type": "code", "source": "!wget -O db2.ipynb https://raw.githubusercontent.com/Db2-DTE-POC/CPDDVHOL4/main/db2.ipynb\n%run db2.ipynb\nprint('db2.ipynb loaded')", "execution_count": 2, "outputs": [{"output_type": "stream", "text": "--2022-02-14 09:08:46--  https://raw.githubusercontent.com/Db2-DTE-POC/CPDDVHOL4/main/db2.ipynb\nResolving raw.githubusercontent.com (raw.githubusercontent.com)... 185.199.111.133, 185.199.110.133, 185.199.108.133, ...\nConnecting to raw.githubusercontent.com (raw.githubusercontent.com)|185.199.111.133|:443... connected.\nHTTP request sent, awaiting response... 200 OK\nLength: 168432 (164K) [text/plain]\nSaving to: \u2018db2.ipynb\u2019\n\ndb2.ipynb           100%[===================>] 164.48K  --.-KB/s    in 0.03s   \n\n2022-02-14 09:08:46 (5.27 MB/s) - \u2018db2.ipynb\u2019 saved [168432/168432]\n\nDb2 Extensions Loaded.\ndb2.ipynb loaded\n", "name": "stdout"}]}, {"metadata": {"id": "eddadf95065b4812898816f51d499014"}, "cell_type": "markdown", "source": "## Connecting to Data Virtualization SQL Engine"}, {"metadata": {"id": "7264f61226244eaab8411000ccf30cea"}, "cell_type": "code", "source": "# Connect to the Db2 STOCKS database on IBM Cloud Pak for Data\ndatabase = 'BIGSQL'\nuser = 'benoit'\npassword = 'abc123'\nhost = 'cpd-zen-40.apps.cp4d.hcs.demo'\nport = '31253'\n\n%sql CONNECT TO {database} USER {user} USING {password} HOST {host} PORT {port}", "execution_count": 3, "outputs": [{"output_type": "stream", "text": "Connection successful.\n", "name": "stdout"}]}, {"metadata": {"id": "f4d054a0f6524a0a8c21ebae98cc35f5"}, "cell_type": "code", "source": "%sql select TABNAME, TABSCHEMA, OWNER from syscat.tables where TABSCHEMA = 'RETAIL' ;", "execution_count": 4, "outputs": [{"output_type": "execute_result", "execution_count": 4, "data": {"text/plain": "        TABNAME TABSCHEMA     OWNER\n0  ORDERDETAILS  RETAIL    ADMIN   \n1  productlines  RETAIL    ADMIN   \n2      products  RETAIL    ADMIN   \n3      TOPSALES  RETAIL    ADMIN   \n4      PAYMENTS  RETAIL    ADMIN   \n5     CUSTOMERS  RETAIL    ADMIN   \n6        ORDERS  RETAIL    ADMIN   \n7       OFFICES  RETAIL    ADMIN   \n8     EMPLOYEES  RETAIL    ADMIN   ", "text/html": "<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>TABNAME</th>\n      <th>TABSCHEMA</th>\n      <th>OWNER</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>ORDERDETAILS</td>\n      <td>RETAIL</td>\n      <td>ADMIN</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>productlines</td>\n      <td>RETAIL</td>\n      <td>ADMIN</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>products</td>\n      <td>RETAIL</td>\n      <td>ADMIN</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>TOPSALES</td>\n      <td>RETAIL</td>\n      <td>ADMIN</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>PAYMENTS</td>\n      <td>RETAIL</td>\n      <td>ADMIN</td>\n    </tr>\n    <tr>\n      <th>5</th>\n      <td>CUSTOMERS</td>\n      <td>RETAIL</td>\n      <td>ADMIN</td>\n    </tr>\n    <tr>\n      <th>6</th>\n      <td>ORDERS</td>\n      <td>RETAIL</td>\n      <td>ADMIN</td>\n    </tr>\n    <tr>\n      <th>7</th>\n      <td>OFFICES</td>\n      <td>RETAIL</td>\n      <td>ADMIN</td>\n    </tr>\n    <tr>\n      <th>8</th>\n      <td>EMPLOYEES</td>\n      <td>RETAIL</td>\n      <td>ADMIN</td>\n    </tr>\n  </tbody>\n</table>\n</div>"}, "metadata": {}}]}, {"metadata": {"id": "d627c277-e532-4e7e-aa8a-709539b11238"}, "cell_type": "markdown", "source": "## Seeing where your Virtualized Data is coming from"}, {"metadata": {"id": "c38818f40df24273878bec0078fa270e"}, "cell_type": "code", "source": "%%sql -a\nSELECT TABSCHEMA, TABNAME\n  FROM SYSCAT.NICKNAMES\n    WHERE TABSCHEMA != 'DVSYS'\n    ORDER BY TABSCHEMA, TABNAME", "execution_count": 5, "outputs": [{"output_type": "execute_result", "execution_count": 5, "data": {"text/plain": "  TABSCHEMA       TABNAME\n0  RETAIL       CUSTOMERS\n1  RETAIL       EMPLOYEES\n2  RETAIL         OFFICES\n3  RETAIL    ORDERDETAILS\n4  RETAIL          ORDERS\n5  RETAIL        PAYMENTS\n6  RETAIL    productlines\n7  RETAIL        products", "text/html": "<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>TABSCHEMA</th>\n      <th>TABNAME</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>RETAIL</td>\n      <td>CUSTOMERS</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>RETAIL</td>\n      <td>EMPLOYEES</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>RETAIL</td>\n      <td>OFFICES</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>RETAIL</td>\n      <td>ORDERDETAILS</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>RETAIL</td>\n      <td>ORDERS</td>\n    </tr>\n    <tr>\n      <th>5</th>\n      <td>RETAIL</td>\n      <td>PAYMENTS</td>\n    </tr>\n    <tr>\n      <th>6</th>\n      <td>RETAIL</td>\n      <td>productlines</td>\n    </tr>\n    <tr>\n      <th>7</th>\n      <td>RETAIL</td>\n      <td>products</td>\n    </tr>\n  </tbody>\n</table>\n</div>"}, "metadata": {}}]}, {"metadata": {"id": "f426835618344664816d31e8872ed62b"}, "cell_type": "code", "source": "%%sql -a\nSELECT N.TABSCHEMA AS TABSCHEMA, N.TABNAME AS TABNAME, S.SRCTABNAME AS SRCTABNAME, S.SRCSCHEMA AS SRCSCHEMA, S.SRCTYPE AS TYPE, S.DRIVER AS DRIVER, S.URL AS URL, S.USER AS USER, S.HOSTNAME AS HOSTNAME, S.PORT AS PORT, S.DBNAME AS DBNAME\n  FROM SYSCAT.NICKNAMES N, TABLE(\n  DVSYS.GET_VT_SOURCES(N.TABSCHEMA, N.TABNAME)) S\n  WHERE N.TABSCHEMA != 'DVSYS'", "execution_count": 6, "outputs": [{"output_type": "execute_result", "execution_count": 6, "data": {"text/plain": "  TABSCHEMA       TABNAME    SRCTABNAME                         SRCSCHEMA  \\\n0  RETAIL       CUSTOMERS     CUSTOMERS                         RETAILCRM   \n1  RETAIL        PAYMENTS      PAYMENTS                         RETAILCRM   \n2  RETAIL          ORDERS        ORDERS                         RETAILCRM   \n3  RETAIL        products      products  \"tests-benoit-marolleau.dataset\"   \n4  RETAIL    productlines  productlines  \"tests-benoit-marolleau.dataset\"   \n5  RETAIL    ORDERDETAILS  ORDERDETAILS                         RETAILCRM   \n6  RETAIL       EMPLOYEES     EMPLOYEES                           ACMEAIR   \n7  RETAIL         OFFICES       OFFICES                           ACMEAIR   \n\n       TYPE                                            DRIVER  \\\n0       DB2                         com.ibm.db2.jcc.DB2Driver   \n1       DB2                         com.ibm.db2.jcc.DB2Driver   \n2       DB2                         com.ibm.db2.jcc.DB2Driver   \n3  BigQuery  com.ibm.jdbc.googlebigquery.GoogleBigQueryDriver   \n4  BigQuery  com.ibm.jdbc.googlebigquery.GoogleBigQueryDriver   \n5       DB2                         com.ibm.db2.jcc.DB2Driver   \n6    Oracle                  com.ibm.jdbc.oracle.OracleDriver   \n7    Oracle                  com.ibm.jdbc.oracle.OracleDriver   \n\n                                                 URL     USER  \\\n0                jdbc:db2://10.7.19.71:446/O01DD6F4:   benoit   \n1                jdbc:db2://10.7.19.71:446/O01DD6F4:   benoit   \n2                jdbc:db2://10.7.19.71:446/O01DD6F4:   benoit   \n3  jdbc:ibm:googlebigquery:AuthenticationMethod=s...            \n4  jdbc:ibm:googlebigquery:AuthenticationMethod=s...            \n5                jdbc:db2://10.7.19.71:446/O01DD6F4:   benoit   \n6     jdbc:ibm:oracle://10.3.66.90:1521;SID=acmeair;  acmeair   \n7     jdbc:ibm:oracle://10.3.66.90:1521;SID=acmeair;  acmeair   \n\n                                            HOSTNAME  PORT  \\\n0                                         10.7.19.71   446   \n1                                         10.7.19.71   446   \n2                                         10.7.19.71   446   \n3  service-account@tests-benoit-marolleau.iam.gse...     0   \n4  service-account@tests-benoit-marolleau.iam.gse...     0   \n5                                         10.7.19.71   446   \n6                                         10.3.66.90  1521   \n7                                         10.3.66.90  1521   \n\n                   DBNAME  \n0                O01DD6F4  \n1                O01DD6F4  \n2                O01DD6F4  \n3  tests-benoit-marolleau  \n4  tests-benoit-marolleau  \n5                O01DD6F4  \n6                 acmeair  \n7                 acmeair  ", "text/html": "<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>TABSCHEMA</th>\n      <th>TABNAME</th>\n      <th>SRCTABNAME</th>\n      <th>SRCSCHEMA</th>\n      <th>TYPE</th>\n      <th>DRIVER</th>\n      <th>URL</th>\n      <th>USER</th>\n      <th>HOSTNAME</th>\n      <th>PORT</th>\n      <th>DBNAME</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>RETAIL</td>\n      <td>CUSTOMERS</td>\n      <td>CUSTOMERS</td>\n      <td>RETAILCRM</td>\n      <td>DB2</td>\n      <td>com.ibm.db2.jcc.DB2Driver</td>\n      <td>jdbc:db2://10.7.19.71:446/O01DD6F4:</td>\n      <td>benoit</td>\n      <td>10.7.19.71</td>\n      <td>446</td>\n      <td>O01DD6F4</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>RETAIL</td>\n      <td>PAYMENTS</td>\n      <td>PAYMENTS</td>\n      <td>RETAILCRM</td>\n      <td>DB2</td>\n      <td>com.ibm.db2.jcc.DB2Driver</td>\n      <td>jdbc:db2://10.7.19.71:446/O01DD6F4:</td>\n      <td>benoit</td>\n      <td>10.7.19.71</td>\n      <td>446</td>\n      <td>O01DD6F4</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>RETAIL</td>\n      <td>ORDERS</td>\n      <td>ORDERS</td>\n      <td>RETAILCRM</td>\n      <td>DB2</td>\n      <td>com.ibm.db2.jcc.DB2Driver</td>\n      <td>jdbc:db2://10.7.19.71:446/O01DD6F4:</td>\n      <td>benoit</td>\n      <td>10.7.19.71</td>\n      <td>446</td>\n      <td>O01DD6F4</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>RETAIL</td>\n      <td>products</td>\n      <td>products</td>\n      <td>\"tests-benoit-marolleau.dataset\"</td>\n      <td>BigQuery</td>\n      <td>com.ibm.jdbc.googlebigquery.GoogleBigQueryDriver</td>\n      <td>jdbc:ibm:googlebigquery:AuthenticationMethod=s...</td>\n      <td></td>\n      <td>service-account@tests-benoit-marolleau.iam.gse...</td>\n      <td>0</td>\n      <td>tests-benoit-marolleau</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>RETAIL</td>\n      <td>productlines</td>\n      <td>productlines</td>\n      <td>\"tests-benoit-marolleau.dataset\"</td>\n      <td>BigQuery</td>\n      <td>com.ibm.jdbc.googlebigquery.GoogleBigQueryDriver</td>\n      <td>jdbc:ibm:googlebigquery:AuthenticationMethod=s...</td>\n      <td></td>\n      <td>service-account@tests-benoit-marolleau.iam.gse...</td>\n      <td>0</td>\n      <td>tests-benoit-marolleau</td>\n    </tr>\n    <tr>\n      <th>5</th>\n      <td>RETAIL</td>\n      <td>ORDERDETAILS</td>\n      <td>ORDERDETAILS</td>\n      <td>RETAILCRM</td>\n      <td>DB2</td>\n      <td>com.ibm.db2.jcc.DB2Driver</td>\n      <td>jdbc:db2://10.7.19.71:446/O01DD6F4:</td>\n      <td>benoit</td>\n      <td>10.7.19.71</td>\n      <td>446</td>\n      <td>O01DD6F4</td>\n    </tr>\n    <tr>\n      <th>6</th>\n      <td>RETAIL</td>\n      <td>EMPLOYEES</td>\n      <td>EMPLOYEES</td>\n      <td>ACMEAIR</td>\n      <td>Oracle</td>\n      <td>com.ibm.jdbc.oracle.OracleDriver</td>\n      <td>jdbc:ibm:oracle://10.3.66.90:1521;SID=acmeair;</td>\n      <td>acmeair</td>\n      <td>10.3.66.90</td>\n      <td>1521</td>\n      <td>acmeair</td>\n    </tr>\n    <tr>\n      <th>7</th>\n      <td>RETAIL</td>\n      <td>OFFICES</td>\n      <td>OFFICES</td>\n      <td>ACMEAIR</td>\n      <td>Oracle</td>\n      <td>com.ibm.jdbc.oracle.OracleDriver</td>\n      <td>jdbc:ibm:oracle://10.3.66.90:1521;SID=acmeair;</td>\n      <td>acmeair</td>\n      <td>10.3.66.90</td>\n      <td>1521</td>\n      <td>acmeair</td>\n    </tr>\n  </tbody>\n</table>\n</div>"}, "metadata": {}}]}, {"metadata": {"id": "85e8992915264c7081c72f44e3c3bf40"}, "cell_type": "code", "source": "%%sql -a \nselect * from table(dvsys.GET_VT_SOURCES('RETAIL', 'PAYMENTS'))", "execution_count": 7, "outputs": [{"output_type": "execute_result", "execution_count": 7, "data": {"text/plain": "        CID  SRCSCHEMA SRCTABNAME SRCTYPE                     DRIVER  \\\n0  DB210000  RETAILCRM   PAYMENTS     DB2  com.ibm.db2.jcc.DB2Driver   \n\n                                   URL    USER    HOSTNAME  PORT    DBNAME  \\\n0  jdbc:db2://10.7.19.71:446/O01DD6F4:  benoit  10.7.19.71   446  O01DD6F4   \n\n                             EXT_CONNID  \n0  5d447888-b5b1-49fc-8424-568cff62dbf9  ", "text/html": "<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>CID</th>\n      <th>SRCSCHEMA</th>\n      <th>SRCTABNAME</th>\n      <th>SRCTYPE</th>\n      <th>DRIVER</th>\n      <th>URL</th>\n      <th>USER</th>\n      <th>HOSTNAME</th>\n      <th>PORT</th>\n      <th>DBNAME</th>\n      <th>EXT_CONNID</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>DB210000</td>\n      <td>RETAILCRM</td>\n      <td>PAYMENTS</td>\n      <td>DB2</td>\n      <td>com.ibm.db2.jcc.DB2Driver</td>\n      <td>jdbc:db2://10.7.19.71:446/O01DD6F4:</td>\n      <td>benoit</td>\n      <td>10.7.19.71</td>\n      <td>446</td>\n      <td>O01DD6F4</td>\n      <td>5d447888-b5b1-49fc-8424-568cff62dbf9</td>\n    </tr>\n  </tbody>\n</table>\n</div>"}, "metadata": {}}]}, {"metadata": {"id": "4f35dec7-df2a-45a0-966e-3a95f4525cc9"}, "cell_type": "markdown", "source": "## Joining Virtualized Data"}, {"metadata": {"id": "671f6ce06dcb4a21a8804c1c354ade52"}, "cell_type": "code", "source": "%sql select prod.\"productName\" as \"Product Count\" from \"RETAIL\".\"products\" prod fetch first 10 rows only;", "execution_count": 8, "outputs": [{"output_type": "execute_result", "execution_count": 8, "data": {"text/plain": "                 Product Count\n0       1999 Yamaha Speed Boat\n1        18th century schooner\n2                   Pont Yacht\n3                The Mayflower\n4    The USS Constitution Ship\n5        The Schooner Bluenose\n6                   HMS Bounty\n7               The Queen Mary\n8                  The Titanic\n9  1980s Black Hawk Helicopter", "text/html": "<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>Product Count</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>1999 Yamaha Speed Boat</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>18th century schooner</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>Pont Yacht</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>The Mayflower</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>The USS Constitution Ship</td>\n    </tr>\n    <tr>\n      <th>5</th>\n      <td>The Schooner Bluenose</td>\n    </tr>\n    <tr>\n      <th>6</th>\n      <td>HMS Bounty</td>\n    </tr>\n    <tr>\n      <th>7</th>\n      <td>The Queen Mary</td>\n    </tr>\n    <tr>\n      <th>8</th>\n      <td>The Titanic</td>\n    </tr>\n    <tr>\n      <th>9</th>\n      <td>1980s Black Hawk Helicopter</td>\n    </tr>\n  </tbody>\n</table>\n</div>"}, "metadata": {}}]}, {"metadata": {"id": "3ba6ef20bf4c46628f71c7e88fa00f61"}, "cell_type": "code", "source": "sqlin = \\\n\"\"\"\nSELECT Db2cus.CUSTOMERNAME as \"CustomerName (Db2 for i)\", OraEmp.lastname as \"LastName (Oracle AIX)\" \nFROM \"RETAIL\".\"CUSTOMERS\" Db2cus, \"RETAIL\".\"EMPLOYEES\" OraEmp \nWHERE Db2cus.SALESREPEMPLOYEENUMBER=OraEmp.employeeNumber;\n\"\"\"\n%sql {sqlin}", "execution_count": 9, "outputs": [{"output_type": "execute_result", "execution_count": 9, "data": {"text/plain": "        CustomerName (Db2 for i) LastName (Oracle AIX)\n0   Mini Gifts Distributors Ltd.              Jennings\n1                Mini Wheels Co.              Jennings\n2           Technics Stores Inc.              Jennings\n3       Corporate Gift Ideas Co.              Jennings\n4      The Sharp Gifts Warehouse              Jennings\n..                           ...                   ...\n95               Vida Sport, Ltd                Gerard\n96                   CAF Imports                Gerard\n97         Precious Collectables                Gerard\n98    Corrida Auto Replicas, Ltd                Gerard\n99    Iberia Gift Imports, Corp.                Gerard\n\n[100 rows x 2 columns]", "text/html": "<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>CustomerName (Db2 for i)</th>\n      <th>LastName (Oracle AIX)</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>Mini Gifts Distributors Ltd.</td>\n      <td>Jennings</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>Mini Wheels Co.</td>\n      <td>Jennings</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>Technics Stores Inc.</td>\n      <td>Jennings</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>Corporate Gift Ideas Co.</td>\n      <td>Jennings</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>The Sharp Gifts Warehouse</td>\n      <td>Jennings</td>\n    </tr>\n    <tr>\n      <th>...</th>\n      <td>...</td>\n      <td>...</td>\n    </tr>\n    <tr>\n      <th>95</th>\n      <td>Vida Sport, Ltd</td>\n      <td>Gerard</td>\n    </tr>\n    <tr>\n      <th>96</th>\n      <td>CAF Imports</td>\n      <td>Gerard</td>\n    </tr>\n    <tr>\n      <th>97</th>\n      <td>Precious Collectables</td>\n      <td>Gerard</td>\n    </tr>\n    <tr>\n      <th>98</th>\n      <td>Corrida Auto Replicas, Ltd</td>\n      <td>Gerard</td>\n    </tr>\n    <tr>\n      <th>99</th>\n      <td>Iberia Gift Imports, Corp.</td>\n      <td>Gerard</td>\n    </tr>\n  </tbody>\n</table>\n<p>100 rows \u00d7 2 columns</p>\n</div>"}, "metadata": {}}]}, {"metadata": {"id": "c1b4f696a8d84dc4836a764d42875c15"}, "cell_type": "code", "source": "## TOP 10 Sales - Not optmized for DV\n# NO CACHE RUN DURATION 4-5 Seconds (remove ORDER BY for immediate result)\nsqlin = \\\n\"\"\"\nSELECT cus.CUSTOMERNAME as \"CustomerName (Db2 for i)\", \n       prod.\"productName\" as \"Product (GCP Big Query)\", \n       pay.paymentDate as \"Sales Date (Db2 for i)\", \n       emp.lastname as \"Sales Rep Name (Oracle)\",\n       O.CITY as \"Sales Rep City(Oracle)\",\n       det.quantityOrdered as \"Qty(Db2 for i)\", \n       det.priceEach as \"Unit Price\",\n       det.quantityOrdered * det.priceEach  as \"TOTAL\"\n\nFROM \"RETAIL\".\"CUSTOMERS\" cus, \n     \"RETAIL\".\"products\" prod, \n     \"RETAIL\".\"PAYMENTS\" pay, \n      \"RETAIL\".\"EMPLOYEES\" emp, \n      \"RETAIL\".\"ORDERS\" orders, \n      \"RETAIL\".\"ORDERDETAILS\" det ,\n      \"RETAIL\".\"OFFICES\" O\n\nWHERE cus.customerNumber=pay.customerNumber \n     AND cus.SALESREPEMPLOYEENUMBER=emp.employeeNumber \n     AND orders.ordernumber=det.orderNumber \n     AND det.productCode= prod.\"productCode\"\n     AND emp.officecode = O.officecode\n\nORDER BY TOTAL DESC \n FETCH FIRST 20 ROWS ONLY ;\n\n\"\"\"\n%sql {sqlin}", "execution_count": 10, "outputs": [{"output_type": "execute_result", "execution_count": 10, "data": {"text/plain": "        CustomerName (Db2 for i)               Product (GCP Big Query)  \\\n0      La Corne D'abondance, Co.  2003 Harley-Davidson Eagle Drag Bike   \n1   Mini Gifts Distributors Ltd.  2003 Harley-Davidson Eagle Drag Bike   \n2   Mini Gifts Distributors Ltd.  2003 Harley-Davidson Eagle Drag Bike   \n3             Baane Mini Imports  2003 Harley-Davidson Eagle Drag Bike   \n4             Baane Mini Imports  2003 Harley-Davidson Eagle Drag Bike   \n..                           ...                                   ...   \n15            Signal Gift Stores  2003 Harley-Davidson Eagle Drag Bike   \n16            Signal Gift Stores  2003 Harley-Davidson Eagle Drag Bike   \n17             Atelier graphique  2003 Harley-Davidson Eagle Drag Bike   \n18             Atelier graphique  2003 Harley-Davidson Eagle Drag Bike   \n19             Atelier graphique  2003 Harley-Davidson Eagle Drag Bike   \n\n   Sales Date (Db2 for i) Sales Rep Name (Oracle) Sales Rep City(Oracle)  \\\n0              2004-12-04                  Bondur                  Paris   \n1              2004-08-28                Jennings          San Francisco   \n2              2005-03-05                Jennings          San Francisco   \n3              2004-11-28                   Jones                 London   \n4              2004-11-04                   Jones                 London   \n..                    ...                     ...                    ...   \n15             2003-06-06                Thompson          San Francisco   \n16             2004-12-17                Thompson          San Francisco   \n17             2004-12-18               Hernandez                  Paris   \n18             2003-06-05               Hernandez                  Paris   \n19             2004-10-19               Hernandez                  Paris   \n\n    Qty(Db2 for i)  Unit Price     TOTAL  \n0             66.0      174.29  11503.14  \n1             66.0      174.29  11503.14  \n2             66.0      174.29  11503.14  \n3             66.0      174.29  11503.14  \n4             66.0      174.29  11503.14  \n..             ...         ...       ...  \n15            66.0      174.29  11503.14  \n16            66.0      174.29  11503.14  \n17            66.0      174.29  11503.14  \n18            66.0      174.29  11503.14  \n19            66.0      174.29  11503.14  \n\n[20 rows x 8 columns]", "text/html": "<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>CustomerName (Db2 for i)</th>\n      <th>Product (GCP Big Query)</th>\n      <th>Sales Date (Db2 for i)</th>\n      <th>Sales Rep Name (Oracle)</th>\n      <th>Sales Rep City(Oracle)</th>\n      <th>Qty(Db2 for i)</th>\n      <th>Unit Price</th>\n      <th>TOTAL</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>La Corne D'abondance, Co.</td>\n      <td>2003 Harley-Davidson Eagle Drag Bike</td>\n      <td>2004-12-04</td>\n      <td>Bondur</td>\n      <td>Paris</td>\n      <td>66.0</td>\n      <td>174.29</td>\n      <td>11503.14</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>Mini Gifts Distributors Ltd.</td>\n      <td>2003 Harley-Davidson Eagle Drag Bike</td>\n      <td>2004-08-28</td>\n      <td>Jennings</td>\n      <td>San Francisco</td>\n      <td>66.0</td>\n      <td>174.29</td>\n      <td>11503.14</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>Mini Gifts Distributors Ltd.</td>\n      <td>2003 Harley-Davidson Eagle Drag Bike</td>\n      <td>2005-03-05</td>\n      <td>Jennings</td>\n      <td>San Francisco</td>\n      <td>66.0</td>\n      <td>174.29</td>\n      <td>11503.14</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>Baane Mini Imports</td>\n      <td>2003 Harley-Davidson Eagle Drag Bike</td>\n      <td>2004-11-28</td>\n      <td>Jones</td>\n      <td>London</td>\n      <td>66.0</td>\n      <td>174.29</td>\n      <td>11503.14</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>Baane Mini Imports</td>\n      <td>2003 Harley-Davidson Eagle Drag Bike</td>\n      <td>2004-11-04</td>\n      <td>Jones</td>\n      <td>London</td>\n      <td>66.0</td>\n      <td>174.29</td>\n      <td>11503.14</td>\n    </tr>\n    <tr>\n      <th>...</th>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n    </tr>\n    <tr>\n      <th>15</th>\n      <td>Signal Gift Stores</td>\n      <td>2003 Harley-Davidson Eagle Drag Bike</td>\n      <td>2003-06-06</td>\n      <td>Thompson</td>\n      <td>San Francisco</td>\n      <td>66.0</td>\n      <td>174.29</td>\n      <td>11503.14</td>\n    </tr>\n    <tr>\n      <th>16</th>\n      <td>Signal Gift Stores</td>\n      <td>2003 Harley-Davidson Eagle Drag Bike</td>\n      <td>2004-12-17</td>\n      <td>Thompson</td>\n      <td>San Francisco</td>\n      <td>66.0</td>\n      <td>174.29</td>\n      <td>11503.14</td>\n    </tr>\n    <tr>\n      <th>17</th>\n      <td>Atelier graphique</td>\n      <td>2003 Harley-Davidson Eagle Drag Bike</td>\n      <td>2004-12-18</td>\n      <td>Hernandez</td>\n      <td>Paris</td>\n      <td>66.0</td>\n      <td>174.29</td>\n      <td>11503.14</td>\n    </tr>\n    <tr>\n      <th>18</th>\n      <td>Atelier graphique</td>\n      <td>2003 Harley-Davidson Eagle Drag Bike</td>\n      <td>2003-06-05</td>\n      <td>Hernandez</td>\n      <td>Paris</td>\n      <td>66.0</td>\n      <td>174.29</td>\n      <td>11503.14</td>\n    </tr>\n    <tr>\n      <th>19</th>\n      <td>Atelier graphique</td>\n      <td>2003 Harley-Davidson Eagle Drag Bike</td>\n      <td>2004-10-19</td>\n      <td>Hernandez</td>\n      <td>Paris</td>\n      <td>66.0</td>\n      <td>174.29</td>\n      <td>11503.14</td>\n    </tr>\n  </tbody>\n</table>\n<p>20 rows \u00d7 8 columns</p>\n</div>"}, "metadata": {}}]}, {"metadata": {"id": "62fb9777-89d2-4fe7-b529-379e7233b8d6"}, "cell_type": "markdown", "source": "## Making Complex SQL Simple to Consume"}, {"metadata": {"id": "4caea2fffdd34efc8d729d3a8306786d"}, "cell_type": "code", "source": "# With DV, you can join 2 virtual tables together or create your own virtual views:     ", "execution_count": 11, "outputs": []}, {"metadata": {"id": "cc02183d-cc0e-4a4d-8b53-af57d3f6464e"}, "cell_type": "markdown", "source": "```sql \nCREATE VIEW \"RETAIL\".TOPSALES as(\n   SELECT cus.CUSTOMERNAME as \"CustomerName (Db2 for i)\", \n       prod.\"productName\" as \"Product (GCP Big Query)\", \n       pay.paymentDate as \"Sales Date (Db2 for i)\", \n       emp.lastname as \"Sales Rep Name (Oracle)\",\n       O.CITY as \"Sales Rep City(Oracle)\",\n       det.quantityOrdered as \"Qty(Db2 for i)\", \n       det.priceEach as \"Unit Price\",\n       det.quantityOrdered * det.priceEach  as \"TOTAL\"\n\nFROM \"RETAIL\".\"CUSTOMERS\" cus, \n     \"RETAIL\".\"products\" prod, \n     \"RETAIL\".\"PAYMENTS\" pay, \n      \"RETAIL\".\"EMPLOYEES\" emp, \n      \"RETAIL\".\"ORDERS\" orders, \n      \"RETAIL\".\"ORDERDETAILS\" det ,\n      \"RETAIL\".\"OFFICES\" O\n\nWHERE cus.customerNumber=pay.customerNumber \n     AND cus.SALESREPEMPLOYEENUMBER=emp.employeeNumber \n     AND orders.ordernumber=det.orderNumber \n     AND det.productCode= prod.\"productCode\"\n     AND emp.officecode = O.officecode); \n```"}, {"metadata": {"id": "0b7e271d03b945529c641cc8b9e4ae1b"}, "cell_type": "code", "source": "%sql SELECT * from \"RETAIL\".\"TOPSALES\" ORDER BY TOTAL DESC FETCH FIRST 200 ROWS ONLY; ", "execution_count": 10, "outputs": [{"output_type": "execute_result", "execution_count": 10, "data": {"text/plain": "    CustomerName (Db2 for i)               Product (GCP Big Query)  \\\n0         Baane Mini Imports  2003 Harley-Davidson Eagle Drag Bike   \n1         Reims Collectables  2003 Harley-Davidson Eagle Drag Bike   \n2         Reims Collectables  2003 Harley-Davidson Eagle Drag Bike   \n3         Reims Collectables  2003 Harley-Davidson Eagle Drag Bike   \n4         Reims Collectables  2003 Harley-Davidson Eagle Drag Bike   \n..                       ...                                   ...   \n195       Signal Gift Stores  2003 Harley-Davidson Eagle Drag Bike   \n196       Signal Gift Stores  2003 Harley-Davidson Eagle Drag Bike   \n197        Atelier graphique  2003 Harley-Davidson Eagle Drag Bike   \n198        Atelier graphique  2003 Harley-Davidson Eagle Drag Bike   \n199        Atelier graphique  2003 Harley-Davidson Eagle Drag Bike   \n\n    Sales Date (Db2 for i) Sales Rep Name (Oracle) Sales Rep City(Oracle)  \\\n0               2004-11-04                   Jones                 London   \n1               2005-06-09                  Bondur                  Paris   \n2               2003-05-21                  Bondur                  Paris   \n3               2003-07-21                  Bondur                  Paris   \n4               2005-01-10                  Bondur                  Paris   \n..                     ...                     ...                    ...   \n195             2003-06-06                Thompson          San Francisco   \n196             2004-12-17                Thompson          San Francisco   \n197             2004-12-18               Hernandez                  Paris   \n198             2003-06-05               Hernandez                  Paris   \n199             2004-10-19               Hernandez                  Paris   \n\n     Qty(Db2 for i)  Unit Price     TOTAL  \n0              66.0      174.29  11503.14  \n1              66.0      174.29  11503.14  \n2              66.0      174.29  11503.14  \n3              66.0      174.29  11503.14  \n4              66.0      174.29  11503.14  \n..              ...         ...       ...  \n195            66.0      174.29  11503.14  \n196            66.0      174.29  11503.14  \n197            66.0      174.29  11503.14  \n198            66.0      174.29  11503.14  \n199            66.0      174.29  11503.14  \n\n[200 rows x 8 columns]", "text/html": "<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>CustomerName (Db2 for i)</th>\n      <th>Product (GCP Big Query)</th>\n      <th>Sales Date (Db2 for i)</th>\n      <th>Sales Rep Name (Oracle)</th>\n      <th>Sales Rep City(Oracle)</th>\n      <th>Qty(Db2 for i)</th>\n      <th>Unit Price</th>\n      <th>TOTAL</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>Baane Mini Imports</td>\n      <td>2003 Harley-Davidson Eagle Drag Bike</td>\n      <td>2004-11-04</td>\n      <td>Jones</td>\n      <td>London</td>\n      <td>66.0</td>\n      <td>174.29</td>\n      <td>11503.14</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>Reims Collectables</td>\n      <td>2003 Harley-Davidson Eagle Drag Bike</td>\n      <td>2005-06-09</td>\n      <td>Bondur</td>\n      <td>Paris</td>\n      <td>66.0</td>\n      <td>174.29</td>\n      <td>11503.14</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>Reims Collectables</td>\n      <td>2003 Harley-Davidson Eagle Drag Bike</td>\n      <td>2003-05-21</td>\n      <td>Bondur</td>\n      <td>Paris</td>\n      <td>66.0</td>\n      <td>174.29</td>\n      <td>11503.14</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>Reims Collectables</td>\n      <td>2003 Harley-Davidson Eagle Drag Bike</td>\n      <td>2003-07-21</td>\n      <td>Bondur</td>\n      <td>Paris</td>\n      <td>66.0</td>\n      <td>174.29</td>\n      <td>11503.14</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>Reims Collectables</td>\n      <td>2003 Harley-Davidson Eagle Drag Bike</td>\n      <td>2005-01-10</td>\n      <td>Bondur</td>\n      <td>Paris</td>\n      <td>66.0</td>\n      <td>174.29</td>\n      <td>11503.14</td>\n    </tr>\n    <tr>\n      <th>...</th>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n    </tr>\n    <tr>\n      <th>195</th>\n      <td>Signal Gift Stores</td>\n      <td>2003 Harley-Davidson Eagle Drag Bike</td>\n      <td>2003-06-06</td>\n      <td>Thompson</td>\n      <td>San Francisco</td>\n      <td>66.0</td>\n      <td>174.29</td>\n      <td>11503.14</td>\n    </tr>\n    <tr>\n      <th>196</th>\n      <td>Signal Gift Stores</td>\n      <td>2003 Harley-Davidson Eagle Drag Bike</td>\n      <td>2004-12-17</td>\n      <td>Thompson</td>\n      <td>San Francisco</td>\n      <td>66.0</td>\n      <td>174.29</td>\n      <td>11503.14</td>\n    </tr>\n    <tr>\n      <th>197</th>\n      <td>Atelier graphique</td>\n      <td>2003 Harley-Davidson Eagle Drag Bike</td>\n      <td>2004-12-18</td>\n      <td>Hernandez</td>\n      <td>Paris</td>\n      <td>66.0</td>\n      <td>174.29</td>\n      <td>11503.14</td>\n    </tr>\n    <tr>\n      <th>198</th>\n      <td>Atelier graphique</td>\n      <td>2003 Harley-Davidson Eagle Drag Bike</td>\n      <td>2003-06-05</td>\n      <td>Hernandez</td>\n      <td>Paris</td>\n      <td>66.0</td>\n      <td>174.29</td>\n      <td>11503.14</td>\n    </tr>\n    <tr>\n      <th>199</th>\n      <td>Atelier graphique</td>\n      <td>2003 Harley-Davidson Eagle Drag Bike</td>\n      <td>2004-10-19</td>\n      <td>Hernandez</td>\n      <td>Paris</td>\n      <td>66.0</td>\n      <td>174.29</td>\n      <td>11503.14</td>\n    </tr>\n  </tbody>\n</table>\n<p>200 rows \u00d7 8 columns</p>\n</div>"}, "metadata": {}}]}, {"metadata": {"id": "1965f864-6c48-413f-8b09-63abab2b3ee5"}, "cell_type": "markdown", "source": "## Performance and Caching"}, {"metadata": {"id": "eca95d6a-1072-421a-ab02-b1bfe9aa5ce0"}, "cell_type": "markdown", "source": "Example of Query Execution \n- No Cache 290s , \n- With Caching : 100s , to 2.5s"}, {"metadata": {"id": "314ae915-9cd2-43b2-a6d8-0ec6f4142de3"}, "cell_type": "code", "source": "", "execution_count": null, "outputs": []}], "metadata": {"kernelspec": {"name": "python3", "display_name": "Python 3.8", "language": "python"}, "language_info": {"name": "python", "version": "3.8.11", "mimetype": "text/x-python", "codemirror_mode": {"name": "ipython", "version": 3}, "pygments_lexer": "ipython3", "nbconvert_exporter": "python", "file_extension": ".py"}}, "nbformat": 4, "nbformat_minor": 1}